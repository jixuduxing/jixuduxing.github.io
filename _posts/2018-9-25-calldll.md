---
layout: page
title: 64位程序+多版本vs的dll调用问题
---


一个破问题，搞了俩小时。

问题：一个windows老程序，主要功能是调用另外一个dll，更新本地数据，重新编译的，vs2013+64位编译，调用原来的VS2010编译的32位dll，死活失败！

先排除了路径的问题，因为调试中看到其实是调用了的，只是后来又unload，windows很多东西不熟，也不知道能否查看错误代码之类，然后就懵逼了！

然后把老dll全部重新编译了一遍，vs2013+x64,中间巴拉巴拉搞了大半个小时，结果完全正常。。

但是这样是不好的，老的dll目前正在使用，必须要新程序兼容老dll，然后重新编译新程序，编译成32位，完美运行！

总结：

1、64位程序跟32位dll之间不能直接调用并访问进程空间，反之亦然！

2、不同版本vs编译的dll是可以互相调用的，只要接口是标准的c接口